<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Docker的安装及使用, 个人博客，秦同学">
    <meta name="description" content="记录生活，秦同学">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="google-site-verification" content="YsNIhmtAieKemmjl6UAClXRrtBP397J1JuGfJXP-I-0" />
	<meta name="baidu-site-verification" content="code-6jg8O9mf80" />
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>


    <title>Docker的安装及使用 | 白月光 | 秦同学</title>
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/favicon.png">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/css/matery.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/css/my.css">

    <script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">白月光 | 秦同学</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">白月光 | 秦同学</div>
        <div class="logo-desc">
            
            记录生活，秦同学
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/26.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Docker的安装及使用</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E8%BF%90%E7%BB%B4%E5%AE%B9%E5%99%A8/">
                                <span class="chip bg-color">运维容器</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/docker/" class="post-category">
                                docker
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2021-06-28
                </div>
				<div class="info-break-policy">
					 
						<i class="fa fa-pencil"></i> 作者: 秦同学 
							 
				</div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    736
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    4 分
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h2><p>1、卸载原有版本</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell"> yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-engine
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、需要的安装包</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">yum install -y yum-utils
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3、设置镜像仓库</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">#默认国外的慢
yum-config-manager \
    --add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo
#阿里云快
    yum-config-manager \
    --add-repo \
    http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
    #更新yum软件包索引
    yum install docker-ce docker-ce-cli containerd.io
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>4、安装docker相关内容    docker-ce 社区      ee 企业版</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">yum install docker-ce docker-ce-cli containerd.io
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>5、启动docker</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">systemctl start docker
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>6、安装成功测试</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 ~]# docker version
Client: Docker Engine - Community
 Version:           20.10.7
 API version:       1.41
 Go version:        go1.13.15
 Git commit:        f0df350
 Built:             Wed Jun  2 11:58:10 2021
 OS/Arch:           linux/amd64
 Context:           default
 Experimental:      true

Server: Docker Engine - Community
 Engine:
  Version:          20.10.7
  API version:      1.41 (minimum version 1.12)
  Go version:       go1.13.15
  Git commit:       b0f5bc3
  Built:            Wed Jun  2 11:56:35 2021
  OS/Arch:          linux/amd64
  Experimental:     false
 containerd:
  Version:          1.4.6
  GitCommit:        d71fcd7d8303cbf684402823e425e9dd2e99285d
 runc:
  Version:          1.0.0-rc95
  GitCommit:        b9ee9c6314599f1b4a7f497e1f1f856fe433d3b7
 docker-init:
  Version:          0.19.0
  GitCommit:        de40ad0
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>7、启动</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 ~]# docker run hello-world
Unable to find image 'hello-world:latest' locally  #寻找镜像
latest: Pulling from library/hello-world
b8dfde127a29: Pull complete 
Digest: sha256:9f6ad537c5132bcce57f7a0a20e317228d382c3cd61edae14650eec68b2b345c
Status: Downloaded newer image for hello-world:latest

Hello from Docker!  #安装成功
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>8、查看一下下载的这个hello-world镜像</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 ~]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    d1165f221234   3 months ago   13.3kB
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>9、docker的运行过程</p>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210622181147951.png" alt="image-20210622181147951"></p>
<p>10、docker怎么工作</p>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210622181322041.png" alt="image-20210622181322041"></p>
<h2 id="卸载docker"><a href="#卸载docker" class="headerlink" title="卸载docker"></a>卸载docker</h2><p>删除依赖</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">yum remove docker-ce docker-ce-cli containerd.io
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>删除资源</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell"> rm -rf /var/lib/docker#    /var/lib/docker docker的工作路径
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="阿里云镜像加速"><a href="#阿里云镜像加速" class="headerlink" title="阿里云镜像加速"></a>阿里云镜像加速</h2><p>1、登陆阿里云找到镜像服务</p>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210620002208558.png" alt="image-20210620002208558"></p>
<p>2、找到镜像加速：</p>
<p><code>[容器镜像服务 (aliyun.com)](https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors)</code></p>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210620002529593.png" alt="image-20210620002529593"></p>
<p>3、配置使用</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">创建一个目录sudo mkdir -p /etc/docker编写配置文件sudo tee /etc/docker/daemon.json <<-'EOF'{  "registry-mirrors": ["https://tr46bges.mirror.aliyuncs.com"]}EOF重启sudo systemctl daemon-reload启动sudo systemctl restart docker
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<h2 id="注意：docker比vm快"><a href="#注意：docker比vm快" class="headerlink" title="注意：docker比vm快"></a>注意：docker比vm快</h2><p>1、docker有这比虚拟机更少的抽象层</p>
<p>2、docker利用的是宿主机的内核，vm需要是Guest OS.</p>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210622181404015.png" alt="image-20210622181404015"></p>
<p>所以说,新建一个容器的时候, docker不需要想虚拟机一样重新加载一个操作系统内核,避免引导。虚拟机是加载Guest os ,分钟级别的,而docker是利用宿主机的操作系统吗,省略了 这个复杂的过程，秒级！</p>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210622181549066.png" alt="image-20210622181549066"></p>
</blockquote>
<h2 id="Docker的常用命令"><a href="#Docker的常用命令" class="headerlink" title="Docker的常用命令"></a>Docker的常用命令</h2><pre><code>docker version     #显示版本信息docker info        #显示docker的系统信息，包括镜像容器的数量docker 命令 --help    #帮助命令
</code></pre><p>帮助文档：<a href="https://docs.docker.com/reference/" target="_blank" rel="noopener">Reference documentation | Docker Documentation</a></p>
<h2 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h2><h4 id="docker-images"><a href="#docker-images" class="headerlink" title="docker images"></a>docker images</h4><p> 查看所有本地的主机上的镜像</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 docker]# docker imagesREPOSITORY    TAG       IMAGE ID       CREATED        SIZEhello-world   latest    d1165f221234   3 months ago   13.3kB#解释REPOSITORY 镜像的仓库TAG            镜像的标签IMAGE ID    镜像的idCREATED        镜像的创建时间SIZE        镜像的大小#    可选项-a , --all        #    列出所有镜像-q , --quiet     #    只显示镜像的id
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="docker-search搜索镜像"><a href="#docker-search搜索镜像" class="headerlink" title="docker search搜索镜像"></a>docker search搜索镜像</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 docker]# docker search mysqlNAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATEDmysql                             MySQL is a widely used, open-source relation…   11028     [OK]       mariadb                           MariaDB Server is a high performing open sou…   4178      [OK]       ···#可选项--filter=STARS=3000 #搜索出来的镜像加速STARS大于3000的[root@Linux02 docker]# docker search --helpUsage:  docker search [OPTIONS] TERMSearch the Docker Hub for imagesOptions:  -f, --filter filter   Filter output based on conditions provided      --format string   Pretty-print search using a Go template      --limit int       Max number of search results (default 25)      --no-trunc        Don't truncate output      [root@Linux02 docker]# docker search mysql --filter=STARS=3000NAME      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATEDmysql     MySQL is a widely used, open-source relation…   11028     [OK]       mariadb   MariaDB Server is a high performing open sou…   4178      [OK]
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="docker-pull-下载镜像"><a href="#docker-pull-下载镜像" class="headerlink" title="docker pull 下载镜像"></a>docker pull 下载镜像</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">#下载镜像 docker pull 镜像名[:tag]    #版本[root@Linux02 docker]# docker pull mysqlUsing default tag: latest    #谷歌如果不写tag，默认就是最后一个latestlatest: Pulling from library/mysql69692152171a: Pull complete     #分层下载（如果重复，不再下载，省内存），docker iamge的核心 联合文件系统1651b0be3df3: Pull complete 951da7386bc8: Pull complete 0f86c95aa242: Pull complete 37ba2d8bd4fe: Pull complete 6d278bb05e94: Pull complete 497efbd93a3e: Pull complete f7fddf10c2c2: Pull complete 16415d159dfb: Pull complete 0e530ffc6b73: Pull complete b0a4a1a77178: Pull complete cd90f92aa9ef: Pull complete Digest: sha256:d50098d7fcb25b1fcb24e2d3247cae3fc55815d64fec640dc395840f8fa80969Status: Downloaded newer image for mysql:latestdocker.io/library/mysql:latest #真实地址#等价docker pull mysql||docker pull docker.io/library/mysql:latest#指定版本下载[root@Linux02 docker]# docker pull mysql:5.75.7: Pulling from library/mysql69692152171a: Already exists 1651b0be3df3: Already exists 951da7386bc8: Already exists 0f86c95aa242: Already exists 37ba2d8bd4fe: Already exists 6d278bb05e94: Already exists 497efbd93a3e: Already exists a023ae82eef5: Pull complete e76c35f20ee7: Pull complete e887524d2ef9: Pull complete ccb65627e1c3: Pull complete Digest: sha256:a682e3c78fc5bd941e9db080b4796c75f69a28a8cad65677c23f7a9f18ba21faStatus: Downloaded newer image for mysql:5.7docker.io/library/mysql:5.7
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="docker-rmi-删除镜像"><a href="#docker-rmi-删除镜像" class="headerlink" title="docker  rmi 删除镜像"></a>docker  rmi 删除镜像</h4><p>rmi = rm image</p>
<p>通过id删除指定镜像</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 docker]# docker imagesREPOSITORY    TAG       IMAGE ID       CREATED        SIZEmysql         5.7       2c9028880e58   5 weeks ago    447MBmysql         latest    c0cdc95609f1   5 weeks ago    556MBhello-world   latest    d1165f221234   3 months ago   13.3kB[root@Linux02 docker]# docker rmi -f 2c9028880e58Untagged: mysql:5.7Untagged: mysql@sha256:a682e3c78fc5bd941e9db080b4796c75f69a28a8cad65677c23f7a9f18ba21faDeleted: sha256:2c9028880e5814e8923c278d7e2059f9066d56608a21cd3f83a01e3337bacd68Deleted: sha256:c49c5c776f1bc87cdfff451ef39ce16a1ef45829e10203f4d9a153a6889ec15eDeleted: sha256:8345316eca77700e62470611446529113579712a787d356e5c8656a41c244aeeDeleted: sha256:8ae51b87111404bd3e3bde4115ea2fe3fd2bb2cf67158460423c361a24df156bDeleted: sha256:9d5afda6f6dcf8dd59aef5c02099f1d3b3b0c9ae4f2bb7a61627613e8cdfe562
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>删除全部镜像</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">docker rmi -f $(docker images -aq) #删除全部的镜像
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h2><p>说明:我们有镜像才能创建容器，linux，下载一个centos镜像来测试学习</p>
<pre><code>docker pull centos
</code></pre><h4 id="新建容器并启动"><a href="#新建容器并启动" class="headerlink" title="新建容器并启动"></a>新建容器并启动</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">docker run [可选参数] image#参数说明--name="Name"     容器名字    tomcat01    tomcat02,用来区分容器-d                后台方式运行 java nohup-it                使用交互方式运行，进入容器查看内容-p                指定容器的端口        -p 8080:8080    -p    ip:主机端口：容器端口    -p    主机端口：容器端口（常用）    -p    容器端口    容器端口-P                随机指定端口#测试，启动并进入容器 （交互模式运行）[root@Linux02 /]# docker run -it centos /bin/bash[root@89655e5ffb86 /]# lsbin  etc   lib      lost+found  mnt  proc  run   srv  tmp  vardev  home  lib64  media       opt  root  sbin  sys  usr
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="exit-退出容器"><a href="#exit-退出容器" class="headerlink" title="exit 退出容器"></a>exit 退出容器</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">#退出[root@89655e5ffb86 /]# exitexit[root@Linux02 /]# lsbin   dev  home  lib64  mnt  proc  run   srv  tmp  varboot  etc  lib   media  opt  root  sbin  sys  usr
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="docker-ps-查看当前运行容器"><a href="#docker-ps-查看当前运行容器" class="headerlink" title="docker ps 查看当前运行容器"></a>docker ps 查看当前运行容器</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 /]# docker psCONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="docker-ps-查看曾经运行过的容器"><a href="#docker-ps-查看曾经运行过的容器" class="headerlink" title="docker ps 查看曾经运行过的容器"></a>docker ps 查看曾经运行过的容器</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">#docker ps 命令    #列出当前正在运行的容器-a #列出当前正在运行的容器+带出历史运行过得容器-n=? #显示最近创建的容器-q #只显示容器[root@Linux02 /]# docker ps -aCONTAINER ID   IMAGE         COMMAND       CREATED         STATUS                          PORTS     NAMES89655e5ffb86   centos        "/bin/bash"   4 minutes ago   Exited (0) About a minute ago             nervous_turing78d9324c6cfd   hello-world   "/hello"      4 days ago      Exited (0) 4 days ago                     pensive_hawking
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="Ctrl-P-Q-退出容器"><a href="#Ctrl-P-Q-退出容器" class="headerlink" title="Ctrl+P+Q 退出容器"></a>Ctrl+P+Q 退出容器</h4><blockquote>
<p>注意： exit #容器停止退出</p>
<p>Ctrl +P + Q  #容器不停止退出</p>
</blockquote>
<h4 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">docker rm 容器id        #删除指定的容器    不能删除正在运行的容器+-f 强制删除docker  rm -f $(docker ps -aq)    #强制删除所有的容器docker ps -a -q|Xargs docker rm    #利用管道删除所有容器
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="启动和停止的操作"><a href="#启动和停止的操作" class="headerlink" title="启动和停止的操作"></a>启动和停止的操作</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">docker start    容器id    #启动容器docker restart    容器id    #重启容器docker stop        容器id    #停止当前运行的容器docker kill        容器id    #强制停止当前容器
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="常用其他命令"><a href="#常用其他命令" class="headerlink" title="常用其他命令"></a>常用其他命令</h2><h4 id="后台启动"><a href="#后台启动" class="headerlink" title="后台启动"></a>后台启动</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">#命令 docker run -d 镜像名！[root@Linux02 /]# docker run -d centos
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="常见的坑"><a href="#常见的坑" class="headerlink" title="常见的坑"></a>常见的坑</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">#问题docker ps,发现centos停住了#常见的坑：docker 容器使用后台运行，就必须要有一个前台进程，docker发现没有应用，就会自动停止#nginx ，容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">docker logs -f -t --tail 10 容器id    #10  代表查询10条日志#编写一段脚本[root@Linux02 /]# docker run -d centos /bin/sh -c "while true;do echo linux02;sleep 1;done"[root@Linux02 /]# docker psCONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES #显示日志-tf            #显示日志--tail number #显示日志的条数[root@Linux02 /]# docker logs -ft --tail 10 3a2f3cdc5aec
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="查看容器中进程信息"><a href="#查看容器中进程信息" class="headerlink" title="查看容器中进程信息"></a>查看容器中进程信息</h4><pre><code>#命令docker top 容器id[root@Linux02 /]# docker top 3a2f3cdc5aecUID                 PID                 PPID                C                   STIME               TTY     root                35358               35339               0                   18:39               ?                  root                35910               35358               0                   18:45               ?
</code></pre><p>查看镜像的源数据</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">#命令docker inspect  容器id# 测试[root@Linux02 /]# docker inspect 3a2f3cdc5aec[    {        "Id": "3a2f3cdc5aecb82cf4e6495a80d864757e9f83289391f6f9b48598062c9073bd",        "Created": "2021-06-24T10:39:32.813550522Z",        "Path": "/bin/sh",        "Args": [            "-c",            "while true;do echo linux02;sleep 1;done"        ],        "State": {            "Status": "running",            "Running": true,            "Paused": false,            "Restarting": false,            "OOMKilled": false,            "Dead": false,            "Pid": 35358,            "ExitCode": 0,            "Error": "",            "StartedAt": "2021-06-24T10:39:33.145603372Z",            "FinishedAt": "0001-01-01T00:00:00Z"        },        "Image": "sha256:300e315adb2f96afe5f0b2780b87f28ae95231fe3bdd1e16b9ba606307728f55",        "ResolvConfPath": "/var/lib/docker/containers/3a2f3cdc5aecb82cf4e6495a80d864757e9f83289391f6f9b48598062c9073bd/resolv.conf",        "HostnamePath": "/var/lib/docker/containers/3a2f3cdc5aecb82cf4e6495a80d864757e9f83289391f6f9b48598062c9073bd/hostname",        "HostsPath": "/var/lib/docker/containers/3a2f3cdc5aecb82cf4e6495a80d864757e9f83289391f6f9b48598062c9073bd/hosts",        "LogPath": "/var/lib/docker/containers/3a2f3cdc5aecb82cf4e6495a80d864757e9f83289391f6f9b48598062c9073bd/3a2f3cdc5aecb82cf4e6495a80d864757e9f83289391f6f9b48598062c9073bd-json.log",        "Name": "/exciting_hypatia",        "RestartCount": 0,        "Driver": "overlay2",        "Platform": "linux",        "MountLabel": "",        "ProcessLabel": "",        "AppArmorProfile": "",        "ExecIDs": null,        "HostConfig": {            "Binds": null,            "ContainerIDFile": "",            "LogConfig": {                "Type": "json-file",                "Config": {}            },            "NetworkMode": "default",            "PortBindings": {},            "RestartPolicy": {                "Name": "no",                "MaximumRetryCount": 0            },            "AutoRemove": false,            "VolumeDriver": "",            "VolumesFrom": null,            "CapAdd": null,            "CapDrop": null,            "CgroupnsMode": "host",            "Dns": [],            "DnsOptions": [],            "DnsSearch": [],            "ExtraHosts": null,            "GroupAdd": null,            "IpcMode": "private",            "Cgroup": "",            "Links": null,            "OomScoreAdj": 0,            "PidMode": "",            "Privileged": false,            "PublishAllPorts": false,            "ReadonlyRootfs": false,            "SecurityOpt": null,            "UTSMode": "",            "UsernsMode": "",            "ShmSize": 67108864,            "Runtime": "runc",            "ConsoleSize": [                0,                0            ],            "Isolation": "",            "CpuShares": 0,            "Memory": 0,            "NanoCpus": 0,            "CgroupParent": "",            "BlkioWeight": 0,            "BlkioWeightDevice": [],            "BlkioDeviceReadBps": null,            "BlkioDeviceWriteBps": null,            "BlkioDeviceReadIOps": null,            "BlkioDeviceWriteIOps": null,            "CpuPeriod": 0,            "CpuQuota": 0,            "CpuRealtimePeriod": 0,            "CpuRealtimeRuntime": 0,            "CpusetCpus": "",            "CpusetMems": "",            "Devices": [],            "DeviceCgroupRules": null,            "DeviceRequests": null,            "KernelMemory": 0,            "KernelMemoryTCP": 0,            "MemoryReservation": 0,            "MemorySwap": 0,            "MemorySwappiness": null,            "OomKillDisable": false,            "PidsLimit": null,            "Ulimits": null,            "CpuCount": 0,            "CpuPercent": 0,            "IOMaximumIOps": 0,            "IOMaximumBandwidth": 0,            "MaskedPaths": [                "/proc/asound",                "/proc/acpi",                "/proc/kcore",                "/proc/keys",                "/proc/latency_stats",                "/proc/timer_list",                "/proc/timer_stats",                "/proc/sched_debug",                "/proc/scsi",                "/sys/firmware"            ],            "ReadonlyPaths": [                "/proc/bus",                "/proc/fs",                "/proc/irq",                "/proc/sys",                "/proc/sysrq-trigger"            ]        },        "GraphDriver": {            "Data": {                "LowerDir": "/var/lib/docker/overlay2/78c7f3984c138eba44faf0041aa79e9ee1eb020797e671a4bbf850831a6822ea-init/diff:/var/lib/docker/overlay2/d25dc6ef6e9a53472448659e1fde7dcbee087a13cf3f9c20f348bf706e7d93fa/diff",                "MergedDir": "/var/lib/docker/overlay2/78c7f3984c138eba44faf0041aa79e9ee1eb020797e671a4bbf850831a6822ea/merged",                "UpperDir": "/var/lib/docker/overlay2/78c7f3984c138eba44faf0041aa79e9ee1eb020797e671a4bbf850831a6822ea/diff",                "WorkDir": "/var/lib/docker/overlay2/78c7f3984c138eba44faf0041aa79e9ee1eb020797e671a4bbf850831a6822ea/work"            },            "Name": "overlay2"        },        "Mounts": [],        "Config": {            "Hostname": "3a2f3cdc5aec",            "Domainname": "",            "User": "",            "AttachStdin": false,            "AttachStdout": false,            "AttachStderr": false,            "Tty": false,            "OpenStdin": false,            "StdinOnce": false,            "Env": [                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"            ],            "Cmd": [                "/bin/sh",                "-c",                "while true;do echo linux02;sleep 1;done"            ],            "Image": "centos",            "Volumes": null,            "WorkingDir": "",            "Entrypoint": null,            "OnBuild": null,            "Labels": {                "org.label-schema.build-date": "20201204",                "org.label-schema.license": "GPLv2",                "org.label-schema.name": "CentOS Base Image",                "org.label-schema.schema-version": "1.0",                "org.label-schema.vendor": "CentOS"            }        },        "NetworkSettings": {            "Bridge": "",            "SandboxID": "879e7b1d29f8a45d519cf76db2b525146ddd8a2bcb1bbfa540170a22bbc84198",            "HairpinMode": false,            "LinkLocalIPv6Address": "",            "LinkLocalIPv6PrefixLen": 0,            "Ports": {},            "SandboxKey": "/var/run/docker/netns/879e7b1d29f8",            "SecondaryIPAddresses": null,            "SecondaryIPv6Addresses": null,            "EndpointID": "6788eae7d5c5b6fc0302184804aa3799ab449a5e9008555446e13b366adbcb34",            "Gateway": "172.17.0.1",            "GlobalIPv6Address": "",            "GlobalIPv6PrefixLen": 0,            "IPAddress": "172.17.0.2",            "IPPrefixLen": 16,            "IPv6Gateway": "",            "MacAddress": "02:42:ac:11:00:02",            "Networks": {                "bridge": {                    "IPAMConfig": null,                    "Links": null,                    "Aliases": null,                    "NetworkID": "e763f97a943002011976c05393aedf41766c8f9beb651045b88b3d54158e9d06",                    "EndpointID": "6788eae7d5c5b6fc0302184804aa3799ab449a5e9008555446e13b366adbcb34",                    "Gateway": "172.17.0.1",                    "IPAddress": "172.17.0.2",                    "IPPrefixLen": 16,                    "IPv6Gateway": "",                    "GlobalIPv6Address": "",                    "GlobalIPv6PrefixLen": 0,                    "MacAddress": "02:42:ac:11:00:02",                    "DriverOpts": null                }            }        }    }]
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="进入当前正在运行的容器docker-exec"><a href="#进入当前正在运行的容器docker-exec" class="headerlink" title="进入当前正在运行的容器docker exec"></a>进入当前正在运行的容器docker exec</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">#我们通常容器都是使用后台方式运行的，需要进入容器，修改一些配置#命令docker exec -it 容器id bashShell[root@Linux02 /]# docker psCONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES3a2f3cdc5aec   centos    "/bin/sh -c 'while t…"   16 minutes ago   Up 16 minutes             exciting_hypatia[root@Linux02 /]# docker exec -it 3a2f3cdc5aec /bin/bash[root@3a2f3cdc5aec /]# lsbin  etc   lib      lost+found  mnt  proc  run   srv  tmp  vardev  home  lib64  media       opt  root  sbin  sys  usr[root@3a2f3cdc5aec /]# ps -efUID         PID   PPID  C STIME TTY          TIME CMDroot          1      0  0 10:39 ?        00:00:00 /bin/sh -c while true;do echo linux02root       1043      0  0 10:56 pts/0    00:00:00 /bin/bashroot       1070      1  0 10:57 ?        00:00:00 /usr/bin/coreutils --coreutils-prog-sroot       1071   1043  0 10:57 pts/0    00:00:00 ps -ef#第二种命令docker attach 容器id[root@Linux02 ~]# docker attach 3a2f3cdc5aec 正在执行当前代码...#docker exec     #进入容器后开启一个新的终端，可以在里面操作（常用）#docker attach    #进入容器正在执行的终端，不会启动新的进程！
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>从容器内拷贝文件到主机上</p>
<p>完整启动流程</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">docker    cp 容器id：容器内路径  目的的的主机路径[root@Linux02 home]# systemctl restart docker #启动服务[root@Linux02 home]# docker run -it centos /bin/bash[root@7d4f759c759a /]# cd /home[root@7d4f759c759a home]# ls[root@7d4f759c759a home]# touch mapper.java[root@7d4f759c759a home]# lsmapper.java[root@7d4f759c759a home]# [root@Linux02 home]# [root@Linux02 home]# docker psCONTAINER ID   IMAGE     COMMAND       CREATED          STATUS          PORTS     NAMES7d4f759c759a   centos    "/bin/bash"   42 seconds ago   Up 41 seconds             strange_neumann[root@Linux02 home]# docker cp 7d4f759c759a:/home/mapper.java /home[root@Linux02 home]# lsmapper  mapper01  mapper.java  mysql  test  test.java
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Nginx的安装"><a href="#Nginx的安装" class="headerlink" title="Nginx的安装"></a>Nginx的安装</h2><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 ~]# docker pull nginx:latest        #安装最新版latest: Pulling from library/nginxb4d181a07f80: Pull complete edb81c9bc1f5: Pull complete b21fed559b9f: Pull complete 03e6a2452751: Pull complete b82f7f888feb: Pull complete 5430e98eba64: Pull complete Digest: sha256:47ae43cdfc7064d28800bc42e79a429540c7c80168e8c8952778c0d5af1c09dbStatus: Downloaded newer image for nginx:latestdocker.io/library/nginx:latest
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>nginx端口暴露</p>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210628143929256.png" alt="image-20210628143929256"></p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 ~]# docker run --name nginx-test -p 8080:80 -d nginxWARNING: IPv4 forwarding is disabled. Networking will not work.989489bed964a37d3a0b2bbdabed0f6c288b3180ac87ec5d75e575370fe9d9b5[root@Linux02 ~]# docker psCONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                                   NAMES989489bed964   nginx     "/docker-entrypoint.…"   2 minutes ago    Up 2 minutes    0.0.0.0:8080->80/tcp, :::8080->80/tcp   nginx-test0e3de4eebf0d   nginx     "/docker-entrypoint.…"   15 minutes ago   Up 15 minutes   0.0.0.0:8081->80/tcp, :::8081->80/tcp   nginx0148fa7f553488   centos    "/bin/bash"              4 hours ago      Up 4 hours                                              vigilant_lamarr[root@Linux02 ~]# docker exec -it  nginx-test /bin/bashroot@989489bed964:/# whereis nginxnginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx#暂停服务docker stop 989489bed964#id号
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h2><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">$ docker run -it --rm tomcat:9.0--rm  #官方坑，意思是用完即删[root@Linux02 ~]# docker run -it tomcat:9.0
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h2><h4 id="基础知识："><a href="#基础知识：" class="headerlink" title="基础知识："></a>基础知识：</h4><p>1、每个保留关键字（指令）必须是大写字母</p>
<p>2、执行从上到下顺序执行</p>
<p>3、#表示注释</p>
<p>4、每一个指令都会创建提交一个新的镜像层，并提交</p>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210628170330239.png" alt="image-20210628170330239"></p>
<p>dockerfile是面向开发的，我们以后要发布项目，做镜像，就需要编写dockerfile文件。</p>
<p>Docker镜像逐渐称为企业交付的标准，必须要掌握！</p>
<p>步骤：开发，部署，运维。。。缺一不可！</p>
<p>DockerFile:构建文件，定义了一切的步骤，源代码</p>
<p>DockerImages：通过DockerFile创键生成的镜像，最终发布和运行的产品！</p>
<p>Docker容器：容器就是镜像运行起来提供服务器</p>
<h4 id="DockerFile的指令"><a href="#DockerFile的指令" class="headerlink" title="DockerFile的指令"></a>DockerFile的指令</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">FROW        #基础镜像，一切从这里开始构建MAINTAINER    #镜像是谁写的，姓名+邮箱RUN            #镜像构建的时候需要运行的命令ADD            #步骤，tomcat镜像，这个tomcat压缩包添加内容WORKDIR        #镜像的工作目录VOLUME        #挂载的目录EXPOST        #保留端口配置CMD            #指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代ENTRYPOINT     #指定这个容器的时候要运行的命令，可以追加命令ONBUITLD     #当构建一个被继承DockerFile这个时候就会运行ONBUITLD的命令，触发指令COPY        #类似ADD，将我们的文件拷贝到镜像中ENV            #构建的时候设置环境变量！
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210628171819746.png" alt="image-20210628171819746"></p>
<p><img src="https://gitee.com/qinjunxiang/p1/raw/master/image-20210628174634088.png" alt="image-20210628174634088"></p>
<h2 id="创建一个centos"><a href="#创建一个centos" class="headerlink" title="创建一个centos"></a>创建一个centos</h2><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">#编写DockerFile的文件[root@Linux02 DockerFile]# vim mydockerfileFROM centos        #基础镜像MAINTAINER mapper<2494543852@qq.com> #创作者ENV MYPATH /usr/local    #定义环境变量WORKDIR $MYPATH        #镜像工作目录RUN yum -y install vim    #执行的命令RUN yum -y install net-toolsEXPOSE 80        #保留的端口配置CMD echo $MYPATHCMD echo  "---end---"    #指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代CMD /bin/bash#运行成功！！！[root@Linux02 DockerFile]# docker build -f mydockerfile  -t mycentos:0.1 .Sending build context to Docker daemon  40.45kBStep 1/10 : FROM centos ---> 300e315adb2fStep 2/10 : MAINTAINER mapper<2494543852@qq.com> ---> Using cache ---> 32e0aa9c2b62Step 3/10 : ENV MYPATH /usr/local ---> Using cache ---> ad38d20e8de3Step 4/10 : WORKDIR $MYPATH ---> Using cache ---> 10f5a5ef29c4Step 5/10 : RUN yum -y install vim ---> Using cache ---> 283b1ebdb120Step 6/10 : RUN yum -y install net-tools ---> Running in b365b31ca012Last metadata expiration check: 0:05:27 ago on Mon Jun 28 14:13:45 2021.Dependencies resolved.================================================================================ Package         Architecture Version                        Repository    Size================================================================================Installing: net-tools       x86_64       2.0-0.52.20160912git.el8       baseos       322 kTransaction Summary================================================================================Install  1 PackageTotal download size: 322 kInstalled size: 942 kDownloading Packages:net-tools-2.0-0.52.20160912git.el8.x86_64.rpm   192 kB/s | 322 kB     00:01    --------------------------------------------------------------------------------Total                                           147 kB/s | 322 kB     00:02     Running transaction checkTransaction check succeeded.Running transaction testTransaction test succeeded.Running transaction  Preparing        :                                                        1/1   Installing       : net-tools-2.0-0.52.20160912git.el8.x86_64              1/1   Running scriptlet: net-tools-2.0-0.52.20160912git.el8.x86_64              1/1   Verifying        : net-tools-2.0-0.52.20160912git.el8.x86_64              1/1 Installed:  net-tools-2.0-0.52.20160912git.el8.x86_64                                     Complete!Removing intermediate container b365b31ca012 ---> 3694841f6400Step 7/10 : EXPOSE 80 ---> Running in 10a0de907858Removing intermediate container 10a0de907858 ---> 59da94f87e89Step 8/10 : CMD echo $MYPATH ---> Running in 1111a370f51cRemoving intermediate container 1111a370f51c ---> 00499beee13dStep 9/10 : CMD echo  "---end---" ---> Running in 11e778fcef16Removing intermediate container 11e778fcef16 ---> db7292416d06Step 10/10 : CMD /bin/bash ---> Running in 5b4f9837175eRemoving intermediate container 5b4f9837175e ---> 5afa174ebe4eSuccessfully built 5afa174ebe4eSuccessfully tagged mycentos:0.1#2、通过这个文件构建镜像                    镜像名：[tag] .#注意 最后加 .docker build -f mydockerfile文件路径  -t mycentos:0.1 .#3、测试[root@Linux02 DockerFile]# docker imagesREPOSITORY    TAG       IMAGE ID       CREATED         SIZEmycentos      0.1       5afa174ebe4e   6 minutes ago   295MBtomcat        latest    b0bf9a4a7c93   2 days ago      667MBnginx         latest    4f380adfc10f   5 days ago      133MBmysql         latest    c0cdc95609f1   6 weeks ago     556MBhello-world   latest    d1165f221234   3 months ago    13.3kBcentos        latest    300e315adb2f   6 months ago    209MB#使用本人写的镜像[root@Linux02 DockerFile]# docker run -it mycentos:0.1 [root@a5ab046603df local]# pwd/usr/local[root@a5ab046603df local]# ifconfigeth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500        inet 172.17.0.3  netmask 255.255.0.0  broadcast 172.17.255.255        ether 02:42:ac:11:00:03  txqueuelen 0  (Ethernet)        RX packets 8  bytes 656 (656.0 B)        RX errors 0  dropped 0  overruns 0  frame 0        TX packets 0  bytes 0 (0.0 B)        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0[root@a5ab046603df local]# exitexit
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="变更历史history"><a href="#变更历史history" class="headerlink" title="变更历史history"></a>变更历史history</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">docker history 镜像id
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>对比之前的centos</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 ~]# docker imagesREPOSITORY    TAG       IMAGE ID       CREATED          SIZEmycentos      0.1       5afa174ebe4e   11 minutes ago   295MBtomcat        latest    b0bf9a4a7c93   2 days ago       667MBnginx         latest    4f380adfc10f   5 days ago       133MBmysql         latest    c0cdc95609f1   6 weeks ago      556MBhello-world   latest    d1165f221234   3 months ago     13.3kBcentos        latest    300e315adb2f   6 months ago     209MB[root@Linux02 ~]# docker history 5afa174ebe4eIMAGE          CREATED          CREATED BY                                      SIZE      COMMENT5afa174ebe4e   12 minutes ago   /bin/sh -c #(nop)  CMD ["/bin/sh" "-c" "/bin…   0B        db7292416d06   12 minutes ago   /bin/sh -c #(nop)  CMD ["/bin/sh" "-c" "echo…   0B        00499beee13d   12 minutes ago   /bin/sh -c #(nop)  CMD ["/bin/sh" "-c" "echo…   0B        59da94f87e89   12 minutes ago   /bin/sh -c #(nop)  EXPOSE 80                    0B        3694841f6400   12 minutes ago   /bin/sh -c yum -y install net-tools             24.9MB    283b1ebdb120   16 minutes ago   /bin/sh -c yum -y install vim                   60.7MB    10f5a5ef29c4   18 minutes ago   /bin/sh -c #(nop) WORKDIR /usr/local            0B        ad38d20e8de3   18 minutes ago   /bin/sh -c #(nop)  ENV MYPATH=/usr/local        0B        32e0aa9c2b62   18 minutes ago   /bin/sh -c #(nop)  MAINTAINER mapper<2494543…   0B        300e315adb2f   6 months ago     /bin/sh -c #(nop)  CMD ["/bin/bash"]            0B        <missing>      6 months ago     /bin/sh -c #(nop)  LABEL org.label-schema.sc…   0B        <missing>      6 months ago     /bin/sh -c #(nop) ADD file:bd7a2aed6ede423b7…   209MB   [root@Linux02 ~]# docker history 300e315adb2fIMAGE          CREATED        CREATED BY                                      SIZE      COMMENT300e315adb2f   6 months ago   /bin/sh -c #(nop)  CMD ["/bin/bash"]            0B        <missing>      6 months ago   /bin/sh -c #(nop)  LABEL org.label-schema.sc…   0B        <missing>      6 months ago   /bin/sh -c #(nop) ADD file:bd7a2aed6ede423b7…   209MB
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>我们可以列出本地进行的变更历史</p>
<h4 id="CMD和ENTRYPOINT区别"><a href="#CMD和ENTRYPOINT区别" class="headerlink" title="CMD和ENTRYPOINT区别"></a>CMD和ENTRYPOINT区别</h4><pre class="line-numbers language-lang-shell"><code class="language-lang-shell">CMD            #指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代ENTRYPOINT     #指定这个容器的时候要运行的命令，可以追加命令
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>测试</p>
<pre class="line-numbers language-lang-shell"><code class="language-lang-shell">[root@Linux02 DockerFile]# cat cmd-centos FROM centosCMD ["ls","-a"]#构建镜像[root@Linux02 DockerFile]# docker build -f cmd-centos  -t cmd:1.0 .Sending build context to Docker daemon  54.27kBStep 1/2 : FROM centos ---> 300e315adb2fStep 2/2 : CMD ["ls","-a"] ---> Running in a31debfa8f0dRemoving intermediate container a31debfa8f0d ---> 4331d0d25c4fSuccessfully built 4331d0d25c4fSuccessfully tagged cmd:1.0#run运行，发现我们的ls -a 命令生效[root@Linux02 DockerFile]# docker run 4331d0d25c4f....dockerenvbindevetchomeliblib64lost+foundmediamnt[root@Linux02 DockerFile]# docker run 4331d0d25c4f -ldocker: Error response from daemon: OCI runtime create failed: container_linux.go:380: starting container process caused: exec: "-l": executable file not found in $PATH: unknown.#cmd 的情况下 -l 替换了CMD["ls","-a"]命令，-l 不是命令所以报错！[root@Linux02 DockerFile]# docker run 4331d0d25c4f ls -altotal 0drwxr-xr-x.   1 root root   6 Jun 28 15:04 .drwxr-xr-x.   1 root root   6 Jun 28 15:04 ..-rwxr-xr-x.   1 root root   0 Jun 28 15:04 .dockerenvlrwxrwxrwx.   1 root root   7 Nov  3  2020 bin -> usr/bindrwxr-xr-x.   5 root root 340 Jun 28 15:04 devdrwxr-xr-x.   1 root root  66 Jun 28 15:04 etcdrwxr-xr-x.   2 root root   6 Nov  3  2020 home
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">秦同学</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://ialoe.top/posts/13285.html">https://ialoe.top/posts/13285.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">秦同学</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E8%BF%90%E7%BB%B4%E5%AE%B9%E5%99%A8/">
                                    <span class="chip bg-color">运维容器</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/valine/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'rpmGPYyUwalUmreTVvmhmkpr-gzGzoHsz',
        appKey: '4RG94YGC3lOguTlGqSwrqbzD',
        notify: 'true' === 'true',
        verify: 'true' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'ヾﾉ≧∀≦)o 来呀！快活呀！'
    });
</script>

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/posts/13285.html">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/26.jpg" class="responsive-img" alt="Docker的安装及使用">
                        
                        <span class="card-title">Docker的安装及使用</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-06-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/docker/" class="post-category">
                                    docker
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%BF%90%E7%BB%B4%E5%AE%B9%E5%99%A8/">
                        <span class="chip bg-color">运维容器</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/1706.html">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/25.jpg" class="responsive-img" alt="Nginx的安装及使用">
                        
                        <span class="card-title">Nginx的安装及使用</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            会话技术
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-06-11
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E2%80%94%E2%80%94nginx/" class="post-category">
                                    服务器——nginx
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/nginx/">
                        <span class="chip bg-color">nginx</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/codeBlock/codeShrink.js"></script>



<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="5283950246"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2020</span>
            <a href="/about" target="_blank">白月光</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
				<!-- //<span id="busuanzi_container_site_uv"> //<span id="busuanzi_container_site_uv">-->
            
            <span>
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
             <span>
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2020";
                    var startMonth = "10";
                    var startDate = "1";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
            <span id="icp"><img src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="http://beian.miit.gov.cn" target="_blank">豫ICP备2020025858号-1</a>
            </span>
            
        </div>
        <!-- <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2494543852@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2494543852" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2494543852" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div> -->
		    <img style="height: 67px;cursor: pointer;" src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/medias/logo2.png" alt="又拍云" onclick="location.href='https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral'">
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/js/matery.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/isome/isome.github.io/js/fireworks.js"></script>
	
    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    

    
    <script src="https://cdn.jsdelivr.net/gh/wind-qin/wind-qin.github.io/libs/instantpage/instantpage.js" type="module"></script>
    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"superSample":2,"position":"right","width":150,"height":300,"hOffset":34,"vOffset":-76},"mobile":{"show":true,"scale":0.5},"react":{"opacity":0.8},"name":{"canvas":"live2dcanvas","div":"live2d-widget"},"dev":{"border":false},"dialog":{"enable":true,"hitokoto":true}});</script></body>
	<script src="/js/snow1.js"></script>
	
	<script type="text/javascript">
	var windowWidth = $(window).width(); 
	if (windowWidth > 768) { 
		document.write('<script type="text/javascript" src="/js/sakura.js">
		<\/script>'); } </script>
	<script type="text/javascript">
		var OriginTitile=document.title,st; 
		document.addEventListener("visibilitychange",function(){ 
			document.hidden?(document.title="咦，你去哪了！",clearTimeout(st)):(document.title="我回来喽！",st=setTimeout(function(){document.title=OriginTitile},3e3)) 
			})</script>
	
</html>
